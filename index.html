<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FNF' - Mobile</title>

  <style>
    @font-face {
      font-family: "MiFuente";
      src: url("assets/fonts/funkin.ttf") format("opentype");
      font-weight: normal;
      font-style: normal;
    }

    body {
      font-family: "MiFuente", system-ui, -apple-system, sans-serif;
    }

    /* ===================== VARIABLES ===================== */
    :root {
      --text: #e0e0e0;
      --card-bg: rgba(0, 0, 0, 0.55);
      --neon-blue: #00eaff;
      --neon-pink: #ff00c8;
      --neon-purple: #b400ff;
      --bg: linear-gradient(45deg, #0f0f0f, #000428, #1a1a1a);
    }

    body.light {
      --text: #1a1a1a;
      --card-bg: rgba(255,255,255,0.7);
      --bg: linear-gradient(45deg, #e6f7ff, #ffffff, #f0f0f0);
    }

    /* ======= FONDO ANIMADO ======= */
    body {
      margin: 0;
      color: var(--text);
      background: linear-gradient(45deg, #0f0f0f, #000638, #1a1a1a);
      background-size: 600% 600%;
      animation: moveBg 12s ease infinite;
    }
    @keyframes moveBg {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* ======= EFECTO DE NEBULOSA NE√ìN ======= */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      z-index: -1;
      background: radial-gradient(circle at 20% 30%, rgba(0, 255, 255, 0.295), transparent 60%),
                  radial-gradient(circle at 80% 70%, rgba(255, 0, 200, 0.288), transparent 60%),
                  radial-gradient(circle at 50% 50%, rgba(179, 0, 255, 0.267), transparent 70%);
      filter: blur(80px);
      animation: nebulaMove 10s ease-in-out infinite alternate;
    }

    .container {
      max-width:1100px;
      margin:40px auto;
      background:var(--card-bg);
      padding:24px;
      border-radius:14px;
      backdrop-filter:blur(12px);
      box-shadow:0 0 25px rgba(0,0,0,.6);
    }

    @keyframes nebulaMove {
      0% { transform: translate(-40px, -40px) scale(1.1); opacity: 0.7; }
      50% { transform: translate(40px, 20px) scale(1.3); opacity: 1; }
      100% { transform: translate(-20px, 40px) scale(1.2); opacity: 0.8; }
    }

    .glow {
      color: white;
      text-shadow:
        0 0 10px var(--neon-blue),
        0 0 20px var(--neon-blue),
        0 0 40px var(--neon-purple),
        0 0 80px var(--neon-purple);
    }

    /* BOT√ìN DE TEMA CONGELADO EN LA ESQUINA */
    .theme-btn {
      font-size:30px;
      cursor:pointer;
      animation: spinGlow 6s linear infinite;
      filter: drop-shadow(0 0 6px var(--neon-blue));
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 10000;
      background: rgba(0,0,0,0.3);
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      border: 1px solid var(--neon-blue);
    }

    @keyframes spinGlow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .menu-btn {
      width:32px;
      height:26px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      cursor:pointer;
    }
    .menu-btn div {
      height:4px;
      background: white;
      border-radius:4px;
      box-shadow:0 0 6px var(--neon-blue);
    }

    #menuPopup {
      position: fixed;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(0,0,0,0.85);
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: .3s ease;
    }
    #menuPopup.show {
      opacity: 1;
      pointer-events: auto;
    }

    #menuContent {
      width: 80%;
      max-width: 360px;
      background: rgba(15,15,15,0.95);
      padding: 25px;
      border-radius: 14px;
      text-align: center;
      border: 2px solid var(--neon-blue);
      box-shadow: 0 0 25px var(--neon-blue);
    }

    #menuContent h2 {
      color:white;
      margin-bottom:20px;
      text-shadow:0 0 10px var(--neon-blue);
    }

    .menu-option {
      display:block;
      margin:18px 0;
      padding:12px;
      font-size:20px;
      font-weight:600;
      color:white;
      border-radius:10px;
      text-shadow:0 0 10px var(--neon-blue);
      border:1px solid var(--neon-blue);
      cursor:pointer;
      background: rgba(0,0,0,0.45);
    }

    #closeMenuPopup {
      margin-top:18px;
      font-size:22px;
      cursor:pointer;
      color:var(--neon-pink);
      text-shadow:0 0 10px var(--neon-pink);
    }

    .apks-grid, .mods-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:24px;
      margin-top:20px;
    }

    .apk-card, .mod-card {
      background: rgba(0,0,0,0.45);
      padding:18px;
      border-radius:12px;
      border:1px solid var(--neon-blue);
      box-shadow:0 0 15px var(--neon-blue);
      text-align:center;
      position: relative;
    }

    .apk-card img, .mod-card img {
      width:100%;
      height:150px;
      object-fit:cover;
      border-radius:10px;
      margin-bottom:14px;
      box-shadow:0 0 12px var(--neon-blue);
    }

    /* SISTEMA DE LIKES */
    .like-container {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.6);
      padding: 5px 10px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 5px;
      border: 1px solid var(--neon-pink);
      cursor: pointer;
      z-index: 5;
    }
    .like-icon { color: #555; transition: 0.3s; }
    .like-container.active .like-icon { color: var(--neon-pink); text-shadow: 0 0 10px var(--neon-pink); }
    .like-count { font-size: 14px; color: white; }

    .coming-soon-card {
      background: rgba(40, 0, 40, 0.4);
      border: 1px dashed var(--neon-pink);
      box-shadow: 0 0 10px var(--neon-pink);
      opacity: 0.8;
      position: relative;
      overflow: hidden;
    }
    .coming-soon-card img {
      filter: blur(8px) grayscale(1);
    }
    .coming-soon-badge {
      position: absolute;
      top: 10px;
      right: -30px;
      background: var(--neon-pink);
      color: white;
      padding: 5px 40px;
      transform: rotate(45deg);
      font-size: 12px;
      font-weight: bold;
      box-shadow: 0 0 10px var(--neon-pink);
    }

    .btn {
      display:inline-block;
      padding:10px 16px;
      margin-top:10px;
      border-radius:8px;
      background: var(--neon-pink);
      color:white;
      font-weight:600;
      text-decoration:none;
      box-shadow:0 0 12px var(--neon-pink);
      cursor: pointer;
      border:none;
    }

    .popup {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 999;
      opacity: 0;
      pointer-events: none;
      transition: opacity .3s ease;
    }
    .popup.show {
      opacity: 1;
      pointer-events: auto;
    }

    .popup-content {
      width: 85%;
      max-width: 450px;
      padding: 20px;
      background: rgba(10,10,10,0.95);
      border-radius: 15px;
      position: relative;
      border: 2px solid var(--neon-blue);
      box-shadow: 0 0 25px var(--neon-blue);
      color: white;
    }

    .popup-close {
      position: absolute;
      top: 8px;
      right: 10px;
      font-size: 26px;
      cursor: pointer;
      color: var(--neon-blue);
    }

    .popup-content img {
      width: 100%;
      border-radius: 10px;
      margin-bottom: 10px;
    }

    .social-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin-top: 30px;
    }

    .social-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(0,0,0,0.6);
      padding: 20px;
      border-radius: 15px;
      border: 2px solid var(--neon-blue);
      box-shadow: 0 0 15px var(--neon-blue);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      width: 140px; 
    }

    .social-item:hover {
      transform: translateY(-10px) scale(1.05);
      box-shadow: 0 0 25px var(--neon-pink);
      border-color: var(--neon-pink);
    }

    .social-item img {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: 0 0 10px var(--neon-blue);
    }

    .section { display:none; }
    .active{ display:block; }

    .news-list {
      text-align: left;
      margin: 15px 0;
      padding-left: 20px;
      line-height: 1.6;
    }
    .news-list li {
      margin-bottom: 8px;
      color: #fff;
    }

    .visitor-counter {
      margin-top: 15px;
      font-size: 14px;
      color: var(--neon-blue);
      text-shadow: 0 0 5px var(--neon-blue);
      border: 1px solid var(--neon-blue);
      display: inline-block;
      padding: 5px 15px;
      border-radius: 20px;
      background: rgba(0,0,0,0.3);
    }

    /* ======= SISTEMA DE COMENTARIOS ======= */
    .comments-section {
      margin-top: 50px;
      padding: 20px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 15px;
      border: 1px solid var(--neon-blue);
    }
    .comment-input-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 25px;
    }
    .comment-input-group input, .comment-input-group textarea {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--neon-blue);
      border-radius: 8px;
      padding: 12px;
      color: white;
      font-family: inherit;
    }
    .comment-input-group textarea { min-height: 80px; resize: none; margin-bottom: 0; }
    
    /* ESTILO DEL CONTADOR */
    .char-counter {
      text-align: right;
      font-size: 12px;
      color: var(--neon-blue);
      margin-top: -5px;
      margin-bottom: 5px;
      transition: color 0.3s;
    }
    .char-counter.limit {
      color: var(--neon-pink);
      font-weight: bold;
    }

    .comment-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
      max-height: 500px;
      overflow-y: auto;
      padding-right: 10px;
    }
    .comment-item {
      background: rgba(255, 255, 255, 0.03);
      padding: 15px;
      border-radius: 10px;
      border-left: 4px solid var(--neon-pink);
      position: relative;
    }
    .comment-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      font-size: 0.9em;
    }
    .comment-user { color: var(--neon-blue); font-weight: bold; }
    .comment-date { opacity: 0.6; font-size: 0.8em; }
    .comment-actions {
      margin-top: 10px;
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }
    .btn-edit {
      background: none; border: 1px solid var(--neon-blue); color: var(--neon-blue);
      padding: 4px 8px; border-radius: 5px; cursor: pointer; font-size: 12px;
    }
    .btn-delete {
      background: none; border: 1px solid var(--neon-pink); color: var(--neon-pink);
      padding: 4px 8px; border-radius: 5px; cursor: pointer; font-size: 12px;
    }

    /* BOT√ìN ADMIN */
    #btnDeleteAll {
      display: none;
      background: linear-gradient(to right, #ff416c, #ff4b2b);
      margin-bottom: 20px;
      width: 100%;
      border: none;
    }

  </style>
</head>

<body>

  <div class="theme-btn" onclick="toggleTheme()">‚òº</div>

  <div id="update-popup" class="popup">
    <div class="popup-content" style="text-align: center;">
      <h2 class="glow" style="margin-top:10px;">¬°Novedades!</h2>
      <p>Que hay de nuevo en esta versi√≥n:</p>
      <ul class="news-list">
        <li>‚ù§Ô∏è ¬°Ya puedes dar Like a tus MODs y Bases favoritas!</li>
        <li>üìå Bot√≥n de tema corregido y mejorado.</li>
        <li>üÜï Apartado de Pr√≥ximos Lanzamientos en Mods.</li>
        <li>üÜï Hay tres Proximos Lanzamientos.</li>
        <li>üÜï Nuevo apartado de Comunidad, en donde podras enviar comentarios.</li>
        <li>üõ†Ô∏è Correcci√≥n de errores menores y mejoras de rendimiento.</li>
      </ul>
      <button class="btn" onclick="closeUpdatePopup()" style="width: 100%; padding: 15px; font-size: 18px;">¬°Entendido!</button>
    </div>
  </div>

  <div id="menuPopup">
    <div id="menuContent">
      <h2>Men√∫</h2>
      <div class="menu-option" onclick="selectSection('apks')">Bases</div>
      <div class="menu-option" onclick="selectSection('mods')">MODs</div>
      <div class="menu-option" onclick="selectSection('comments-area')">Comunidad</div>
      <div class="menu-option" onclick="selectSection('contact')">Contacto</div>
      <div id="closeMenuPopup" onclick="toggleMenu()">‚úñ</div>
    </div>
  </div>

  <div class="container">
    <header style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <div class="menu-btn" onclick="toggleMenu()">
        <div></div><div></div><div></div>
      </div>
      <h1 class="glow">Friday Night Funkin'</h1>
    </header>

    <section>
      <h1>Bienvenido a FNF' - Mobile</h1>
      <p>Tu rinc√≥n de mods para Friday Night Funkin' Mobile. ¬°Explora y descarga!</p>
    </section>

    <div class="games-grid">
      <section id="apks" class="section active">
        <h2 class="glow">Descargas</h2>
        <div class="apks-grid">
          <div class="apk-card">
            <div class="like-container" onclick="handleLike('apk1', this)">
                <span class="like-icon">‚ù§</span> <span class="like-count" id="count-apk1">0</span>
            </div>
            <img src="assets/images/logopsych.png">
            <h3>Psych Engine</h3>
            <button class="btn" onclick="openApkInfo('apk1')">M√°s informaci√≥n</button>
          </div>
          <div class="apk-card">
            <div class="like-container" onclick="handleLike('apk2', this)">
                <span class="like-icon">‚ù§</span> <span class="like-count" id="count-apk2">0</span>
            </div>
            <img src="assets/images/logoonline.png">
            <h3>Psych Online</h3>
            <button class="btn" onclick="openApkInfo('apk2')">M√°s informaci√≥n</button>
          </div>
          <div class="apk-card">
            <div class="like-container" onclick="handleLike('apk3', this)">
                <span class="like-icon">‚ù§</span> <span class="like-count" id="count-apk3">0</span>
            </div>
            <img src="assets/images/logocode.png">
            <h3>CodeName Engine</h3>
            <button class="btn" onclick="openApkInfo('apk3')">M√°s informaci√≥n</button>
          </div>
        </div>
      </section>

      <section id="mods" class="section">
        <h2 class="glow">MODs Disponibles</h2>
        <div class="mods-grid">
          <div class="mod-card">
            <div class="like-container" onclick="handleLike('mod1', this)">
                <span class="like-icon">‚ù§</span> <span class="like-count" id="count-mod1">0</span>
            </div>
            <h3>VS Jeffy V3 (BABY BF VS BABY PICO)</h3><button class="btn" onclick="openModInfo('mod1')">M√°s informaci√≥n</button>
          </div>

          <div class="mod-card">
            <div class="like-container" onclick="handleLike('mod3', this)">
                <span class="like-icon">‚ù§</span> <span class="like-count" id="count-mod3">0</span>
            </div>
            <h3>Cocoa Noimix</h3><button class="btn" onclick="openModInfo('mod3')">M√°s informaci√≥n</button>
          </div>
          <div class="mod-card">
            <div class="like-container" onclick="handleLike('mod4', this)">
                <span class="like-icon">‚ù§</span> <span class="like-count" id="count-mod4">0</span>
            </div>
            <h3>Vs Metal Pipe V2</h3><button class="btn" onclick="openModInfo('mod4')">M√°s informaci√≥n</button>
          </div>
          <div class="mod-card">
            <div class="like-container" onclick="handleLike('mod5', this)">
                <span class="like-icon">‚ù§</span> <span class="like-count" id="count-mod5">0</span>
            </div>
            <h3>Rolling Girl</h3><button class="btn" onclick="openModInfo('mod5')">M√°s informaci√≥n</button>
          </div>
        </div>

        <h2 class="glow" style="margin-top: 50px;">Pr√≥ximos Lanzamientos ‚è≥</h2>
        <div class="mods-grid">
          <div class="mod-card coming-soon-card">
            <div class="coming-soon-badge">PR√ìXIMAMENTE</div>
            <img src="assets/images/mods/fate.png"> <h3>Vs. Impostor: Tainted Fate</h3>
            <p style="font-size: 12px; color: var(--neon-pink);">Estado: 63% Completado</p>
          </div>
          <div class="mod-card coming-soon-card">
            <div class="coming-soon-badge">PR√ìXIMAMENTE</div>
            <img src="assets/images/mods/tales.png"> <h3>Vs. Herobrine Reborn Tales</h3>
            <p style="font-size: 12px; color: var(--neon-pink);">Estado: 70% Completado</p>
          </div>
          <div class="mod-card coming-soon-card">
            <div class="coming-soon-badge">PR√ìXIMAMENTE</div>
            <img src="assets/images/mods/over.png"> <h3>FCR: Overwritten</h3>
            <p style="font-size: 12px; color: var(--neon-pink);">Estado: En desarrollo...</p>
          </div>
        </div>
      </section>

      <div id="apk-popup" class="popup"><div class="popup-content"><span class="popup-close" onclick="closeApkInfo()">‚úñ</span><img id="apk-img"><h2 id="apk-title"></h2><p id="apk-desc"></p><h3 id="apk-version" style="color:#00eaff; margin-bottom:10px;"></h3><div id="apk-downloads"></div></div></div>
      <div id="mod-popup" class="popup"><div class="popup-content"><span class="popup-close" onclick="closeModInfo()">‚úñ</span><img id="popup-img"><h2 id="popup-title"></h2><p id="popup-desc"></p><h3 id="popup-version" style="color:#00eaff; margin-bottom:10px;"></h3><div id="popup-downloads"></div></div></div>

      <section id="comments-area" class="section">
        <h2 class="glow">Caja de Comentarios</h2>
        <div class="comments-section">
          <button id="btnDeleteAll" class="btn" onclick="deleteAllComments()">‚ö†Ô∏è ELIMINAR TODOS LOS MENSAJES ‚ö†Ô∏è</button>

          <div class="comment-input-group">
            <input type="text" id="userName" placeholder="Tu apodo (ej: LaloCF)*">
            <textarea id="commentText" placeholder="Escribe tu mensaje... (M√°x 100 caracteres)*" maxlength="100" oninput="updateCharCount()"></textarea>
            <div id="charCounter" class="char-counter">0 / 100</div>
            
            <button class="btn" id="commentBtn" onclick="addComment()">Publicar Comentario</button>
          </div>
          <div class="comment-list" id="commentList"></div>
        </div>
      </section>

      <section id="contact" class="section">
        <h2 class="glow">Redes Sociales</h2>
        <div class="social-grid">
          <div class="social-item"><img src="assets/icons/youtube.jpeg"><a class="btn" href="https://youtube.com/@lalocf_1?si=ASXtn2p-4HBn9H1L" target="_blank">YouTube</a></div>
          <div class="social-item"><img src="assets/icons/telegram.jpeg"><a class="btn" href="https://t.me/lalo_cf_mods" target="_blank">Telegram</a></div>
          <div class="social-item"><img src="assets/icons/instagram.jpeg"><a class="btn" href="https://instagram.com/lalo_cf1" target="_blank">Instagram</a></div>
          <div class="social-item"><img src="assets/icons/tiktok.jpeg"><a class="btn" href="https://tiktok.com/@lalo_cf" target="_blank">TikTok</a></div>
        </div>
      </section>

      <footer style="margin-top:40px; text-align:center; color:white;">
        ¬© <span id="year"></span> LaloCF | V2.2.0
        <br>
        <div class="visitor-counter">Visitas: <span id="count">...</span></div>
      </footer>
    </div>
  </div>

<script>
const APP_VERSION = "v2.2.0"; 
let editModeId = null;

// AQU√ç DEFINE TU CLAVE MAESTRA (La primera vez que abras la web, se te asignar√° una)
// Si quieres que el bot√≥n aparezca siempre en tu dispositivo actual:
const OWNER_KEY = MY_KEY_CURRENT = localStorage.getItem('fnf_user_key');

if(!localStorage.getItem('fnf_user_key')) {
    localStorage.setItem('fnf_user_key', 'user_' + Math.random().toString(36).substr(2, 9));
}
const MY_KEY = localStorage.getItem('fnf_user_key');

window.addEventListener('load', () => {
    const lastVersionSeen = localStorage.getItem('lastVersionSeen');
    if (lastVersionSeen !== APP_VERSION) {
        document.getElementById('update-popup').classList.add('show');
    }
    document.getElementById('year').innerText = new Date().getFullYear();
    updateVisitorCount();
    loadComments();
    loadLikes();
    checkAdminStatus(); // Nueva funci√≥n para mostrar el bot√≥n
});

/* --- FUNCI√ìN PARA MOSTRAR BOT√ìN SOLO A TI --- */
function checkAdminStatus() {
    // Como el almacenamiento es LOCAL, este bot√≥n solo aparecer√° en el navegador 
    // donde creaste la p√°gina originalmente o si conoces la clave.
    const btn = document.getElementById('btnDeleteAll');
    if (MY_KEY === OWNER_KEY) {
        btn.style.display = 'block';
    }
}

function deleteAllComments() {
    if (MY_KEY !== OWNER_KEY) return;
    if (confirm("¬øEST√ÅS SEGURO? Esto borrar√° absolutamente todos los mensajes de la comunidad.")) {
        localStorage.setItem('fnf_comments', JSON.stringify([]));
        loadComments();
        alert("Todos los mensajes han sido eliminados.");
    }
}

/* --- FUNCION DEL CONTADOR DE CARACTERES --- */
function updateCharCount() {
    const textarea = document.getElementById('commentText');
    const counter = document.getElementById('charCounter');
    const length = textarea.value.length;
    
    counter.innerText = `${length} / 100`;
    
    if (length >= 100) {
        counter.classList.add('limit');
    } else {
        counter.classList.remove('limit');
    }
}

/* --- SISTEMA DE LIKES LOCALES --- */
function loadLikes() {
    const likes = JSON.parse(localStorage.getItem('fnf_likes') || '{}');
    const userLikes = JSON.parse(localStorage.getItem('fnf_user_liked') || '[]');
    
    document.querySelectorAll('.like-container').forEach(container => {
        const onclickAttr = container.getAttribute('onclick');
        if(!onclickAttr) return;
        const match = onclickAttr.match(/'([^']+)'/);
        if(!match) return;
        const id = match[1];
        const countSpan = document.getElementById('count-' + id);
        if(countSpan) countSpan.innerText = likes[id] || 0;
        if(userLikes.includes(id)) container.classList.add('active');
    });
}

function handleLike(id, element) {
    let likes = JSON.parse(localStorage.getItem('fnf_likes') || '{}');
    let userLikes = JSON.parse(localStorage.getItem('fnf_user_liked') || '[]');
    
    if(userLikes.includes(id)) {
        likes[id] = (likes[id] || 1) - 1;
        userLikes = userLikes.filter(item => item !== id);
        element.classList.remove('active');
    } else {
        likes[id] = (likes[id] || 0) + 1;
        userLikes.push(id);
        element.classList.add('active');
    }
    
    localStorage.setItem('fnf_likes', JSON.stringify(likes));
    localStorage.setItem('fnf_user_liked', JSON.stringify(userLikes));
    document.getElementById('count-' + id).innerText = likes[id];
}

/* --- TEMA Y MEN√ö --- */
const savedTheme = localStorage.getItem("theme");
if (savedTheme) { document.body.classList.toggle("light", savedTheme === "light"); }

function toggleTheme() {
  document.body.classList.toggle("light");
  localStorage.setItem("theme", document.body.classList.contains("light") ? "light" : "dark");
}

function toggleMenu() { document.getElementById("menuPopup").classList.toggle("show"); }
function closeUpdatePopup() { document.getElementById('update-popup').classList.remove('show'); localStorage.setItem('lastVersionSeen', APP_VERSION); }

function selectSection(id) {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  toggleMenu();
}

function updateVisitorCount() {
    document.getElementById('count').innerText = "Habilitado";
}

function loadComments() {
    const savedComments = JSON.parse(localStorage.getItem('fnf_comments') || '[]');
    const list = document.getElementById('commentList');
    list.innerHTML = savedComments.length ? '' : '<p style="text-align:center; opacity:0.5;">A√∫n no hay mensajes. ¬°S√© el primero!</p>';
    [...savedComments].reverse().forEach(c => {
        const item = document.createElement('div');
        item.className = 'comment-item';
        const isOwner = c.ownerKey === MY_KEY;
        const actionsHtml = isOwner ? `<div class="comment-actions"><button class="btn-edit" onclick="prepareEdit('${c.id}')">Editar</button><button class="btn-delete" onclick="deleteComment('${c.id}')">Eliminar</button></div>` : '';
        item.innerHTML = `<div class="comment-header"><span class="comment-user">${c.user}</span><span class="comment-date">${c.date} ${c.edited ? '(editado)' : ''}</span></div><div class="comment-body">${c.text}</div>${actionsHtml}`;
        list.appendChild(item);
    });
}

function addComment() {
    const user = document.getElementById('userName').value.trim();
    let text = document.getElementById('commentText').value.trim();
    
    if(!user || !text) return alert("Por favor, llena ambos campos.");
    
    if(text.length > 100) {
        text = text.substring(0, 100);
    }

    let comments = JSON.parse(localStorage.getItem('fnf_comments') || '[]');
    if(editModeId) {
        const idx = comments.findIndex(c => c.id === editModeId);
        if(idx !== -1) { comments[idx].text = text; comments[idx].user = user; comments[idx].edited = true; }
        editModeId = null;
        document.getElementById('commentBtn').innerText = "Publicar Comentario";
    } else {
        comments.push({ id: 'id_' + Date.now(), ownerKey: MY_KEY, user: user, text: text, date: new Date().toLocaleString(), edited: false });
    }
    localStorage.setItem('fnf_comments', JSON.stringify(comments));
    document.getElementById('userName').value = ''; 
    document.getElementById('commentText').value = '';
    updateCharCount(); 
    loadComments();
}

function prepareEdit(id) {
    const comments = JSON.parse(localStorage.getItem('fnf_comments') || '[]');
    const comment = comments.find(c => c.id === id);
    if(comment) {
        document.getElementById('userName').value = comment.user;
        document.getElementById('commentText').value = comment.text;
        document.getElementById('commentBtn').innerText = "Guardar Cambios";
        editModeId = id;
        updateCharCount();
        document.getElementById('comments-area').scrollIntoView({behavior: 'smooth'});
    }
}

function deleteComment(id) {
    if(!confirm("¬øSeguro que quieres borrar este comentario?")) return;
    let comments = JSON.parse(localStorage.getItem('fnf_comments') || '[]');
    comments = comments.filter(c => c.id !== id);
    localStorage.setItem('fnf_comments', JSON.stringify(comments));
    loadComments();
}

const MOD_DATA = {
  mod1: {
    img: "assets/images/mods/logojeffy.jpeg",
    title: "VS Jeffy V3 (BABY BF VS BABY PICO)",
    desc: "Friday Night Funkin' FNF' Vs Jeffy V3 Port Psych Engine Optimizado Para (Pc/Android).",
    version: "v1.0",
    downloads: [{ name: "Descarga", link: "assets/zip/VS Jeffy V3 (BABY BF VS BABY PICO).zip" }]
  },
  mod2: {
    img: "assets/images/mods/logonusky.jpeg",
    title: "VS Nusky",
    desc: "Friday Night Funkin' FNF' Vs Nusky Mod Psych Engine Optimizado Para (Pc/Android).",
    version: "v1.0",
    downloads: [
      { name: "Descarga", link: "https://github.com/LaloCF2/Mods-Psych-Engine/releases/download/Ports/Vs.Nusky.zip" },
      { name: "Descarga (GameBanana)", link: "https://gamebanana.com/mods/369981" }
    ]
  },
  mod3: {
    img: "assets/images/mods/chritmas.jpeg",
    title: "Cocoa Noimix",
    desc: "Friday Night Funkin' FNF' Cocoa Noimix Port Psych Engine Optimizado Para (Pc/Android/iOS).",
    version: "v1.0",
    downloads: [
      { name: "Descarga (GameBanana)", link: "https://gamebanana.com/mods/643242" },
      { name: "Descarga Directa (Drive)", link: "https://drive.usercontent.google.com/u/0/uc?id=1wnnGhworUMdReUrlEMMh5C4in4OoHHrU&export=download" },
      { name: "Descarga Directa iOS (Drive)", link: "https://drive.usercontent.google.com/u/0/uc?id=11AUlGXUvPrxszI5xnjssMS5OvZDFp64_&export=download" },
      { name: "Descarga Directa Opt (Drive)", link: "https://drive.usercontent.google.com/u/0/uc?id=1EO-TOh4KByE0gSf24DXx2pG10WR8wdhU&export=download" }
    ]
  },
  mod4: {
    img: "assets/images/mods/metal.png",
    title: "Vs Metal Pipe V2",
    desc: "Friday Night Funkin' FNF' Vs Metal Pipe V2 Port Psych Engine Optimizado Para (Pc/Android) y en especial iOS.",
    version: "v1.0",
    downloads: [
      { name: "Descarga (GameBanana)", link: "https://gamebanana.com/mods/441630"},
      { name: "Descarga Directa (Drive)", link: "https://drive.usercontent.google.com/u/0/uc?id=1g5liWScsGSSd_FCmDtLEOVPQSQtp6E8B&export=download"}
    ]
  },
  mod5: {
    img: "assets/images/mods/Girl.png",
    title: "Rolling Girl",
    desc: "Friday Night Funkin' FNF' Rolling Girl Port Psych Engine Optimizado Para (Pc/Android/iOS).",
    version: "0.5.2 PE",
    downloads: [
      { name: "Descarga (GameBanana)", link: "https://gamebanana.com/mods/42313?lang=es" },
      { name: "Descarga Directa (Drive)", link: "https://drive.usercontent.google.com/u/0/uc?id=1n_e-lmvGFeIybTIDkdHXnduEIeXziD8I&export=download" }
    ]
  }
};

function openModInfo(id) {
  const data = MOD_DATA[id];
  document.getElementById("popup-img").src = data.img;
  document.getElementById("popup-title").innerText = data.title;
  document.getElementById("popup-desc").innerText = data.desc;
  document.getElementById("popup-version").innerText = data.version;
  let html = "";
  data.downloads.forEach(d => { html += `<a class="btn" style="display:block; margin-top:10px;" href="${d.link}" download>${d.name}</a>`; });
  document.getElementById("popup-downloads").innerHTML = html;
  document.getElementById("mod-popup").classList.add("show");
}
function closeModInfo() { document.getElementById("mod-popup").classList.remove("show"); }

const APK_DATA = {
  apk1: {
    img: "assets/images/logopsychengine.png",
    title: "Psych Engine",
    desc: "Motor usado originalmente en Mind Games Mod, concebido para solucionar los numerosos problemas de la versi√≥n original, manteniendo el aspecto de juego casual. Tambi√©n busca ser una alternativa m√°s sencilla para programadores principiantes.",
    version: "v1.0.4",
    downloads: [
      { name: "Descarga Windows64 (Github)", link: "https://github.com/ShadowMario/FNF-PsychEngine/releases/download/1.0.4/PsychEngine-Windows64.zip" },
      { name: "Descarga Windows32 (Github)", link: "https://github.com/ShadowMario/FNF-PsychEngine/releases/download/1.0.4/PsychEngine-Windows32.zip" },
      { name: "Descarga Linux (Github)", link: "https://github.com/ShadowMario/FNF-PsychEngine/releases/download/1.0.4/PsychEngine-Linux.zip"},
      { name: "Descarga Mac (Github)", link: "https://github.com/ShadowMario/FNF-PsychEngine/releases/download/1.0.4/PsychEngine-MacOS.zip"},
      { name: "Descarga Android (Github)", link: "https://github.com/LaloCF2/LaloCF/releases/download/Psych-Engine-v1.0.4/Psych.Engine.v1.0.4.Android.apk" },
      { name: "Descarga iOS (Github)", link: "https://github.com/LaloCF2/LaloCF/releases/download/Psych-Engine-v1.0.4/PsychEngine.v1.0.4.iOS.ipa" }
    ]
  },
  apk2: {
    img: "assets/images/logopsychonline.png",
    title: "Psych Online",
    desc: "Mod de Psych Engine con funciones en l√≠nea.",
    version: "v0.13.2 Bugfix",
    downloads: [
      { name: "Descarga Windows (Github)", link: "https://github.com/Snirozu/Funkin-Psych-Online/releases/download/0.13.2/windowsBuild.zip" },
      { name: "Descarga Linux (Github)", link: "https://github.com/Snirozu/Funkin-Psych-Online/releases/download/0.13.2/linuxBuild.zip" },
      { name: "Descarga Mac (Github)", link: "https://github.com/Snirozu/Funkin-Psych-Online/releases/download/0.13.2/macBuild.zip"},
      { name: "Descarga Android (Github)", link: "https://github.com/Prohack202020/Funkin-Psych-Online/releases/download/0.13.2-bugfix-mobile/PsychOnline-Android.apk" },
      { name: "Descarga iOS (Github)", link: "https://github.com/Prohack202020/Funkin-Psych-Online/releases/download/0.13.2-bugfix-mobile/PsychOnline-iOS.ipa" }
    ]
  },
  apk3: {
    img: "assets/images/logocodename.png",
    title: "CodeName Engine",
    desc: "Codename Engine es una bifurcaci√≥n de Friday Night Funkin' con un enfoque en codificaci√≥n suave y modding.",
    version: "v1.0.1",
    downloads: [
      { name: "Descarga Windows (Github)", link: "https://github.com/CodenameCrew/CodenameEngine/releases/download/v1.0.1/Codename.Engine-Windows.zip" },
      { name: "Descarga Linux (Github)", link: "https://github.com/CodenameCrew/CodenameEngine/releases/download/v1.0.1/Codename.Engine-Linux.zip" },
      { name: "Descarga Mac (Github)", link: "https://github.com/CodenameCrew/CodenameEngine/releases/download/v1.0.1/Codename.Engine-Mac.zip"},
      { name: "Descarga Android (Github)", link: "https://github.com/CPsP-Team/CodenameEngine-Mobile/releases/download/v1.0.1-mobile/CodenameEngineAndroid.apk"},
      { name: "Descarga iOS (Github)", link: "https://github.com/CPsP-Team/CodenameEngine-Mobile/releases/download/v1.0.1-mobile/CodenameEngineiOS.ipa" }
    ]
  }
};

function openApkInfo(id) {
  const data = APK_DATA[id];
  document.getElementById("apk-img").src = data.img;
  document.getElementById("apk-title").innerText = data.title;
  document.getElementById("apk-desc").innerText = data.desc;
  document.getElementById("apk-version").innerText = data.version;
  let html = "";
  data.downloads.forEach(d => { html += `<a class="btn" style="display:block; margin-top:10px;" href="${d.link}" download>${d.name}</a>`; });
  document.getElementById("apk-downloads").innerHTML = html;
  document.getElementById("apk-popup").classList.add("show");
}
function closeApkInfo() { document.getElementById("apk-popup").classList.remove("show"); }
</script>

</body>
</html>











